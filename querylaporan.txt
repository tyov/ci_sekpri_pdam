CREATE TABLE #Laporan
(
TGL_TERIMA smalldatetime,
BAGIAN varchar(20),
JUMLAH int
)

INSERT INTO #Laporan 
SELECT TGL_TERIMA, BAGIAN, COUNT(ID_BERKAS) AS JUMLAH
FROM TBL_BERKAS
GROUP BY BAGIAN, TGL_TERIMA

DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX);

SET @cols = STUFF((SELECT distinct ',' + QUOTENAME(c.BAGIAN) 
            FROM #Laporan c
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query=
'SELECT CONVERT(varchar(20), TGL_TERIMA, 105) as TGL_TERIMA, ' + @cols + ' from 
            (
                select CONVERT(varchar(20), TGL_TERIMA, 105) as TGL_TERIMA
                    ,sum(JUMLAH) as JUMLAH
                    , BAGIAN
                from #Laporan group by CONVERT(varchar(20), TGL_TERIMA, 105),BAGIAN
           ) x
            pivot 
            (
                 sum(JUMLAH)
                for BAGIAN in (' + @cols + ')
            ) p '


execute(@query)

drop table #Laporan
